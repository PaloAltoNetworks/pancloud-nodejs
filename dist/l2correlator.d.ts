import { EmitterInterface } from "./emitter";
interface Event {
    time_generated: string;
    sessionid: string;
}
interface L3event extends Event {
    src: string;
    dst: string;
}
interface L2event extends Event {
    "extended-traffic-log-mac": string;
    "extended-traffic-log-mac-stc": string;
}
export declare type CorrelatedEvent = L2event & L3event;
export interface ProcResponse {
    plain: EmitterInterface<any[]>[];
    correlated?: EmitterInterface<CorrelatedEvent[]>;
}
/**
 * Runtime statistics generated by the L2/L3 correlation engine
 */
export interface CorrelationStats {
    /**
     * Number of entries removed from the correlation buffer due to age out condition
     */
    agedOut: number;
    /**
     * Peak number of entries held in the correlation buffer pending from an eventual correlation event
     */
    dbWaterMark: number;
    /**
     * Number of entries that have been inserted into the correlation buffer
     */
    dbInserts: number;
    /**
     * Number of events that have been refused to join the correlation event because didn't provide
     * the mandatory L2 or L3 attributes needed for correlation to happen
     */
    discardedEvents: number;
}
export declare class MacCorrelator {
    private ageout;
    private absoluteTime;
    private gbMultiplier;
    private gbAttempt;
    private db;
    private lastTs;
    stats: CorrelationStats;
    constructor(ageout?: number, absoluteTime?: boolean, gbMultiplier?: number);
    private gb;
    private update;
    process(e: EmitterInterface<any[]>): ProcResponse;
    flush(): ProcResponse;
}
export {};
